<main class="container">
  <header class="hero">
    <h1>{{ title }}</h1>
    <p>Extract MP3 audio directly in your browserâ€”no cloud uploads or API keys required.</p>
  </header>

  <section class="config">
    <h2>How it works</h2>
    <p class="config-summary">
      The first run loads Mediabunny's media codecs (a few megabytes) and keeps every conversion on
      your device. Nothing leaves your browser unless you share the output file.
    </p>
  </section>

  <section class="uploader">
    <label
      class="file-drop"
      [class.dragging]="isDragOver()"
      (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)"
      (drop)="onDrop($event)"
    >
      <input
        id="fileInput"
        type="file"
        accept="video/*,audio/*"
        (change)="onFileSelected($event)"
      />
      <div class="instructions">
        <strong>Select a video</strong>
        <span>or drag &amp; drop it here</span>
        <small>We will transcode it locally with Mediabunny and give you an MP3 download.</small>
      </div>
    </label>

    <div class="actions">
      <button type="button" (click)="convertSelected()" [disabled]="!selectedFile() || isConverting()">
        {{ isConverting() ? 'Converting...' : 'Extract Audio' }}
      </button>
      <button type="button" class="secondary" (click)="cancelConversion()" *ngIf="isConverting()">
        Cancel
      </button>
      <button type="button" class="link" (click)="clearSelection()" [disabled]="isConverting() || !selectedFile()">
        Clear selection
      </button>
    </div>
  </section>

  <section class="file-details" *ngIf="selectedFile() as file">
    <h2>Selected file</h2>
    <p>
      <span class="filename">{{ file.name }}</span>
      <span class="filesize">({{ formatBytes(file.size) }})</span>
    </p>
  </section>

  <section class="progress-area" *ngIf="isConverting() || progress() > 0">
    <div class="progress-header">
      <h2>Progress</h2>
      <span>{{ progress() }}%</span>
    </div>
    <progress [value]="progress()" max="100"></progress>
  </section>

  <p class="status">{{ status() }}</p>
  <p class="error" *ngIf="errorMessage()">{{ errorMessage() }}</p>

  <section class="download" *ngIf="downloadUrl()">
    <h2>Download</h2>
    <a
      class="download-link"
      [href]="downloadUrl()"
      [download]="(outputFileName() ?? 'audio.mp3')"
    >
      Download {{ outputFileName() || 'audio.mp3' }}
    </a>
  </section>

  <section class="logs" *ngIf="logs().length">
    <h2>Conversion log</h2>
    <pre>{{ logs().join('\n') }}</pre>
  </section>

  <footer>
    <small>
      Conversions run entirely on-device with Mediabunny. Cancel a job any time and nothing leaves
      your computer.
    </small>
  </footer>
</main>
